<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script> 

<script type="text/javascript" src="http://dev.jquery.com/view/trunk/plugins/tablesorter/2.0/jquery.tablesorter.js"></script>

<script type="text/javascript">
  $(document).ready(
    function() 
    { 
  <!--
      $("table").tablesorter({ 
        headers: { 
          {% for header in table_headers %}
            {% if not forloop.first %}
              {{ forloop.counter0 }}: {sorter: false}
              {% if not forloop.last %},{% endif %}
            {% endif %}
          {% endfor %}
        } 
      }); 
-->
      $("#sortTable").tablesorter({
        sortList: [
        {% for header in table_headers %}
          [
          {{ forloop.counter0 }},
          {% if header.descending %}
            1
          {% else %}
            0
          {% endif %}
          ]
          {% if not forloop.last %}
            ,
          {% endif %}
        {% endfor %}
        ]
      }); 
      
<!--
      {% for header in table_headers %}
        $("#trigger-{{ forloop.counter0 }}").click(function() { 
          var sorting = [[0,0]]; 
          $("table").trigger("sorton",[sorting]); 
          return false; 
        }); 
      {% endfor %}
-->

<!--
      $("#trigger-debug").click(function() { 
        var sorting = [[0,1]]; 
        $("table").trigger("sorton",[sorting]); 
        return false; 
      }); 
-->
    } 
  ); 
</script>

<table class="tablesorter" id="sortTable">
  <thead>
    <tr>
      {% for header in table_headers %}
        {% if header.align %}
          <th align="{{ header.align }}">
        {% else %}
          <th>
        {% endif %}
        {{ header.field }}</th>
<!--        <a href="#" id="trigger-{{ forloop.counter0 }}">{{ header.field }}</a></th> -->
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for row in table_rows %}
      <tr class="{% cycle odd even %}">
	{% for element in row %}
	  {% if element.align %}
	    <td align="{{ element.align }}">
	  {% else %}
	    <td>
	  {% endif %}
	  {{ element.field }}</td>
	{% endfor %}
      </tr>
    {% endfor %}
  </tbody>
  {% if table_footers %}
    <tfoot>
      <tr>
        {% for footer in table_footers %}
          <td>{{ footer }}</td>
        {% endfor %}
      </tr>
    </tfoot>
  {% endif %}
</table>


<a href="#" id="trigger-debug">Trigger!</a>
